
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<!-- FOOTER LEFT "Firefly : Plots" -->
<HEAD>
<TITLE>Firefly: Plots
</TITLE>

</HEAD>

<BODY BGCOLOR="white" >

<h2>Firefly: Plots</h2>

Plots can be made from <a href="tables.html">Firefly Tables</A>.
Plotting is covered in this section. The <a
href="tables.html">Tables</A> section discusses tables more generally,
but also the specific case of loading catalogs. If you also have <a
href="visualization.html">Visualization</A> capability installed, and
your table has RA and Dec in it, you can overlay it on images. <P>


<em>Contents of page/chapter:</em><br>
+<a href="#default">Default Plot</A><br>
+<a href="#firstlook">Plot Format: A First Look</A><br>
+<a href="#navigation">Plot Navigation</A><br>
+<a href="#linking">Plot Linking</A><br>
+<a href="#changing">Changing What is Plotted</A><br>
+<a href="#manipulating">Plotting Manipulated Columns</A><br>
+<a href="#restricting">Restricting What is Plotted</A><br>
+<a href="#overplotting">Overplotting</A><br>
+<a href="#adding">Adding Plots</A><br>
+<a href="#example">Example Plots</A><br>
<P>&nbsp;<P>



<h3><a name="default">Default Plot</A></h3>

By default, after a catalog has loaded, a plot appears in the browser
window.<P>

To obtain a full-screen view of your plot, click on the expand icon in
the upper right of the window pane when your mouse is in the window:
<img src="img/expand-24x24.png">. To return to the prior view, click
the "Close" arrow in the upper left.<P>

The plotting tool, by default, starts with RA and Dec plotted  -- if
it can find RA and Dec in the catalog. Note that it plots following
astronomical convention -- RA increases to the left. If the catalog
does not have RA and Dec, it plots the first two numerical columns it
finds. <P>

<h3><a name="firstlook">Plot format: a first look</A></h3>

If you have loaded a catalog with many (&gt; 15,000) points, you may
have an RA/Dec plot that looks something like the one on the left
here. If you have loded a catalog with few (&lt; 15,000) points, you
will have an RA/Dec plot that looks more like the one on the right
here.<br> <img src="img/defaultradecbinned.png" width="50%"><img
src="img/defaultradecunbinned.png" width="50%"><P>

The difference between them is that, for larger catalogs (left), the
plot is binned -- more points are encompassed in a black tile and
fewer points are encompassed in a white tile. In the context of this
tool, this is called a <strong>heatmap</strong>. For smaller catalogs
(right), each individual point is shown as a blue dot. In the context
of this tool, this is called a <strong>scatter plot</strong>. <P>

In either case, letting your mouse hover over a point tells you the
values of the point under your cursor, and (if binned) how many points
are represented:<br> <img src="img/morethanonepoint.png"> for binned
plots, and <br> <img src="img/justonepoint.png"> for just one point.
<br> <img src="img/morethanonepoint2.png"> Clicking (in an unbinned
plot)  highlights that point, and it stays highlighted, though you
must keep your mouse on the point in order to see the information
about how many points it represents.<P>

You can change the bin size and shading. If you have a binned plot,
you have a "binning options" arrow near the bottom of the plot options
pop-up. You can choose whether the binning is set automatically (leave
boxes blank), or by you (populate the boxes). You can also choose if
the grey shading is set linearly or logarithmically.  NOTE
THAT you can't change the bin size in just one direction; if you enter
a number for the "Number of x-bins" box, you must also enter a number
for the "Number of y-bins" box.<P>

The reason the tool makes a heatmap for large catalogs this is to more
fairly represent the point density -- and to make the plotting faster.
In these cases, though, it will not give you the option to overplot
errors (see below). If you have a heatmap and want a scatter plot, you
need to filter or otherwise restrict the catalog to have fewer points
(see below).<P>




<h3><a name="navigation">Plot Navigation</A></h3>

The top right of the plot window has a row of icons: 
<img src="img/plotnav.png" align="center"> which we now describe.<P>

<DL>
<DT><img src="img/plotnav-zoom.png"> <em>Zoom in plot</em>
<DD>When you click on this icon, it becomes "active", e.g., it is
underlined in red. Then, when you click and drag in the plot, the plot
is zoomed to the region you have selected. You can also zoom using
your scroll feature on your mouse. To return to the original
view, click on <img src="img/plotnav-1x.png" align="center">. <P>

<DT><img src="img/plotnav-pan.png"> <em>Pan across plot</em> 
<DD>When you click on this icon, it becomes "active", e.g., it is
underlined in red. Then, when you click and drag in the plot, it moves
around in response to where you drag. To return to the original view,
click on <img src="img/plotnav-1x.png" align="center">. <P>

<DT><img src="img/plotnav-select.png"> <em>Select within plot</em>  
<DD>When you click on this icon, it becomes "active", e.g., it is
underlined in red. Then, when you click and drag in the plot, you are
given additional options : <img src="img/plotnav-filter.png"
align="center"> The checkmark means "select" and the funnel means
"filter." The difference is that filtering (temporarily) limits what
is shown in the plot, catalog, and image (see <a
href="tables.html#filters">general information on filters</A>), and
selecting just highlights the points enclosed within your selection.
<P>

<DT><img src="img/plotnav-1x.png"> <em>Re-scale plot</em>  
<DD> Return to the view that optimizes the range of x and y to show
the currently displayed points. <P>

<DT><a name="saving"><img src="img/plotnav-save.png"> <em>Save
plot</em></A>
<DD>Save the plot. It will save as a png file, whereever your browser
is configured to save files.The saved PNG is the same size as it is on
your screen. If you want a big version, make the desired plot big on
your screen (expand the view to take up as much space as possible)
before saving the PNG. <P>

<DT><img src="img/plotnav-undo.png"> <em>Undo</em>  
<DD> Restore everything to the defaults. If you've played a lot with
the plot, you may want to undo everything you've done. Click this icon
to restore everything back to the defaults.  <P>

<DT><img src="img/plotnav-filter2.png"> <em>Filter from plot</em>  
<DD> Pull up interactive filters.  This button brings up filters for
the displayed catalog in an interface <a href="tables.html">like all
the other tables here</A>, except you don't see the values in the
catalog themselves; you can enter filters here in the same way you can
everywhere else in this tool (see <a
href="tables.html#filters">general information on filters</A>). <P>

<DT><img src="img/xyplotoptions.png"> <em>Configure plot</em>  
<DD> Click on this icon to <a href="#changing">change what is
plotted</A> (much more on this below).<P>
<P>

<DT><img src="img/expand-24x24.png"> <em>Expand plot</em>  
<DD> Click on the this icon to make the
plot take up the whole browser window. To return to the prior view,
click the "Close" arrow in the upper left.<P>
</dl>




<h3><a name="linking">Plot Linking:</A> Plots are linked to catalog and image(s)</h3>

If you move your mouse over any of the points in the plot, you will
get a pop-up telling you the values corresponding to the point under
your cursor. For scatter plots, if you click on any of the points, the
object(s) corresponding to that point will be highlighted in the
overlays in the images shown, and highlighted in the catalog table. 
This works the other way too - click on a row in the catalog, or an
object in the images, and the object will be highlighted in the plot
or the catalog or the image.<P>



<h3><a name="changing">Changing what is plotted</A></h3>

To change what is plotted, click on the gears icon in the upper right
of the plot window pane: <img src="img/xyplotoptions.png"
align="center">. Configuration options then appear; the options are a
little different depending on whether the points are binned or
not:<br>  <img src="img/plotoptionspopup-decimated.png" width="30%"> &nbsp; &nbsp;
<img src="img/plotoptionspopup.png" width="30%"><br> The left has the
options for binned plots, and the right has the options for plots that
have individual points shown. <P>

This section describes how to change
what is plotted, e.g., the "Modify Trace" option at the top of both of
these pop-ups. Both <a href="#overplotting">overplotting</A> and <a
href="#adding">addding plots</A> are covered in more detail below. <P>

<DL><dt><strong>Both kinds of plots have the following
options.</strong>

<dd> In either case, you can <strong>specify what should be plotted on
each axis</strong>. The magnifying glass is a link that brings up a
table that lists all of the available columns in the catalog.
Alternatively, you can just start typing, and viable options appear
below the box. Whatever you put in the box must match the column name
as shown in the catalog <em>exactly</em>. <P>

Click on the black triangle to reveal additional options. <P>

In both of the examples above, RA is plotted on the x-axis. It has
pulled the column name for the label; in this table, the column is
"ra" rather than "RA". It has copied over the units ("deg") from the
catalog, and plotted the x-axis increasing to the left as per
astronomical convention. You can change what column is plotted, and
whether or not errors are shown.

Under "<strong>Chart Options</strong>", you can specify:
<UL>
<LI>title of the plot;
<LI>labels on the x and y-axis;
<LI>whether or not there is a grid;
<LI>whether or not the axis is reversed (as for ra in the examples
above);
<LI>whether the x-axis is on the top or bottom and the y-axis is on
the left or right;
<LI>whether or not the axis is logarithmic;
<LI>the maximum and minimum values of the plot range;
<LI>the aspect ratio of the plot (e.g., square or rectangular).
</UL> <P>

By default, the boundaries of the plot are set to encompass the full
data range. Here you can change the boundaries to specific numbers.
(This can also be set via filtering from the plot; see below.)<P>

You can enter <strong>simple mathematical relations</strong> in these
boxes too, such as (for a WISE catalog) "w1mpro-w4mpro" to put
[W1]-[W4] on one axis.
Supported operators:
<UL>
<LI>+,-,*,/
<LI>abs(x), acos(x), asin(x), atan(x), atan2(x), ceil(x), cos(x),
exp(x), floor(x), lg(x), ln(x), log10(x), log(x), power(x,y),
round(x), sin(x), sqrt(x), tan(x)
<LI>Non-alphanumeric column names (e.g., those with - or + or similar
characters) should be quoted in expressions.
</UL>
<P>


Click "Apply" to apply, and "Close" to return to the plot without
making changes.<P>

<dt><strong>Options found only in binned plots</strong>
<dd>(Plots are binned if there are &gt; 15,000 points in the catalog.)
From the pop-up, you can control the color table that is used
(greyscale is the default; there are many other choices in the
pulldown menu), as well as the number of bins in the x and y
directions.   If you change the number of bins but then want to go
back to the original default values, leave the "Number of bins" boxes
blank.<P>


<dt><strong>Options found only in plots showing individual points</strong>
<dd>You can specify an error (either a column in the catalog, or
calculated from a column in the catalog). Those errors can be
symmetric or asymmetric (select from the pulldown menu).<P>

Right below where you specify the columns for the x and y axis, under
"<strong>Trace Style</strong>,"  you can control whether the points
are shown as individual points, connected points, or just lines
connecting the points. <P>

Under <strong>Trace Options</strong>, you have many choices. 
<UL>
<LI>Choose the <strong>symbol type</strong>: circle (default), open
circle, square, open square, diamond, open diamond, cross, x,
upward-pointing triangle, hexagon, or star. <P>
<LI><A name="colorpicker">Choose the <strong>color</strong>. By
default, the point color is a mid-range blue that is darker where more
points. This is specified by the rgba vector shown in the example
above (31, 119, 180, 0.5) where the last number is a unit of fraction
of 1, so 50% in this example.  Click on the magnifying glass to bring
up a color picker window:<br><img src="img/colorpickerplot.png"><br>
From here, you can click on your desired color in the top colorful
box. Immediately below that box, you can change the color and
saturation of the top box so that you can select from a different
range of colors. Below that, you can enter numerical Hex codes or RGBA
values (where the value for RGB is between 0 and 255, and A is in
units of percent, e.g., 50 = 50%).  Finally, you can also select from
a pre-defined set of 15 colors by clicking on the small box. Note ha
the numerical codes update as you select different colors. Click "OK"
to implement your color choice, or click 'x' in the upper right to
close the window without changing the color.<P>
<strong>Tip:</strong> Don't like the transparency feature of the
points that makes them darker when there are more points? Set the last
value of the vector (A) to 1. Don't like the blue? Pick a diferent
color entirely. Want the faintest point to be brighter than it is by
default? Set the last element of the color vector ("A") to be 0.7 or
0.8.<P>
<LI>Choose the <strong>color map</strong>. By default, all of the
points are the same color, but darker where there are more points. You
can change this such that the color scale of the points is tied to a
column value, such as w1snr (WISE-1 signal-to-noise ratio) in a WISE
catalog. If you select this option, you can also change the color
scale to any of 18 options (see the pulldown). Simple mathematical
relations (as above) are also permitted in this box.<P>
<LI>Choose the <strong>size map</strong>. By default, all of the
points are the same size. You can change this such that the color
scale of the points is tied to a column value, such as w1snr (WISE-1
signal-to-noise ratio) in a WISE catalog. Simple mathematical
relations (as above) are also permitted in this box.<P>
</UL> 
<P>
<P>
</dl>


Example: Load a large WISE catalog. Plot w1snr (WISE-1 signal-to-noise
ratio) vs. w1mpro (WISE-1 profile fitted magnitude). It defaults to a
heatmap. Change the labels by clicking on the triangles below each
entry box, and make the y-axis label "WISE-1 SNR" rather than the more
cryptic column header "w1snr". Change the x-axis label to "[W1]."
Depending on your catalog, you may need to adjust the y axis range.
Obtain this plot:<P> <img src="img/w1snrexample.png" width="60%"><img
src="img/w1snrexampleconfig.png" width="40%"><p>


Example: Load either a smaller WISE catalog, or the same large WISE
catalog, but <a href="tables.html#filters">filter</A> it down such
that w1snr, w2snr, and w3snr are all greater than 10, which limits the
number of points to be &lt;15,000. Plot w1snr vs. w1mpro. It shows the
points individually Change the labels.  Change the point color map to
scale with w2mpro (WISE-2 profile fitted magnitude). Change the point
size map to scale with w4snr (WISE-4 signal-to-noise). Obtain this
plot:<P> <img src="img/w1snrexample2.png" width="60%"><img
src="img/w1snrexample2config.png" width="40%"><p>




<h3><a name="manipulating">Plotting Manipulated Columns</A></h3>

You can choose a single column to plot against another column, as
above. However, you can also do simple mathematical manipulations.<P>

For example, if you have loaded a WISE catalog, you can plot [W1]-[W2]
vs. [W3]-[W4]. In terms of the names of the columns in the database,
this is w1mpro-w2mpro vs. w3mpro-w4mpro.  <br>

<img src="img/wisecolorexample.png" width="60%"><img
src="img/wisecolorexampleconfig.png" width="40%"><p>


If you have few enough points that the plot is not binned, you can add
errors, and you can also manipulate those.  Here, the expression for the
x-axis errors is sqrt(power(w1sigmpro,2)+power(w2sigmpro,2)) and for
the y-axis errors, it is sqrt(power(w3sigmpro,2)+power(w4sigmpro,2)). <br> 
<img src="img/plotoptionspopup2-plot.png" width="60%"><img
src="img/plotoptionspopup2.png" width="40%"> <P>






<h3><a name="restricting">Restricting What is Plotted (from the plot)</A></h3>


You can also restrict what data are plotted in any of several
different ways. <P>

You can <a href="tables.html#filters">filter the catalog</A> from the
table itself (discussed in another section).<P> 

You can set axis limits on the plot itself from the plot options
pop-up (discussed above).<P>

However, and perhaps more powerfully, you can set limits from the plot
itself using a rubber band zoom.  Click on the select icon in the plot
(<img src="img/plotnav-select.png" align="center">) Click and drag in
a sub-region of the plot. New icons appear: <img
src="img/plotnav-filter.png" align="center"> If you click on the
funnel icon, only those data points that pass the filter are shown in
the plot, in the table, and/or overlaid on the image(s). (This is the
behavior of 'filter', as opposed to 'select'; the former restricts
what is shown, the latter just highlights the points.) For more on
filters, see <a href="tables.html#filters">the filtering dicussion in
the tables section</A>.<P>

Example: Obtain a WISE catalog of a star-forming region, say IC1396.
Filter down the catalog to only have WISE-1 and WISE-4 detections
(limits have undefined errors, so ask the catalog to filter down such
that w1sigmpro&gt;0, w2sigmpro&gt;0, w3sigmpro&gt;0, and
w4sigmpro&gt;0. Plot w1mpro-w4mpro on the x-axis, and w1mpro on the
y-axis. Reverse the y-axis to put bright objects at the top. Click and
drag in the plot to select the bright and red objects, and filter them
down to get a subset of bright and red sources. For clarity, the
screenshot here has the sources selected, not filtered.<br>

<img src="img/wisecmdselection.png" width="60%"><img
src="img/wisecmdselectionconfig.png" width="40%"><p>



<h3><a name="overplotting">Overplotting</A> </h3>

<em>(As of this writing, this is an "alpha" release of this capability,
and the plan is to continue development.)</em><P>

At the top of the pop-up that you get when you click on the gears, you
have three radio buttons: <img src="img/overplot1.png" align="center">
They are "Add New Chart" (see <a href="#adding">next section</A>),
"Overplot New Trace" (this section), and "Modify Trace" (see above
sections). In this section, we will cover overplotting. This is
sometimes called "multi-trace," meaning that more than one thing is
plotted. <P>

When you select "Overplot New Trace," you get a new interface that is
very similar to the original interface where you selected what to
plot:<br>
<img src="img/overplot2.png"><P>

As before, you need to :
<UL>
<LI>select a plot type (scatter, heatmap, histogram);
<LI>tell it what column(s) you want for x, y, and associated errors;
<LI>select the trace style (points, connected points, lines);
<LI>set any trace options;
<LI>set any chart options.
</UL>

Right now, the overplotting can only work from the same catalog --
that is, you cannot plot [W1] vs. [W1]-[W4] from one catalog and
overplot [W1] vs. [W1]-[W4] from another catalog.<P>

You can easily get yourself into a physically nonsensical situation,
say, by overplotting a histogram onto a scatter plot. If you find
yourself in a hopeless mess, click on the "undo" icon to reset
everything  <img src="img/plotnav-undo.png" align="center"> and try
again.<P>

The best way to explain how to use this feature is probably via an
example.  We have a plot of [W1] vs. [W1-W4] from above. Now  add on
top of it a plot of [W2] vs. [W1-W4]. Click on the gears to bring up
the pop-up. Select "Overplot New Trace." Enter "w1mpro-w4mpro" for x
and "w2mpro" for y. Expand "Chart Options." Note that it has preserved
the overall chart title from before, but has erased the X and Y labels
(and lost the reversal of the y axis) because the overplot could
literally be anything, and need not be the same columns or even the
same units as what is already plotted. Type them in again. This is the
configuration window right before clicking "ok", and the resultant
plot. <br> <img src="img/overplot3.png" width="40%"><img
src="img/overplot4.png" width="60%"><p> Note that there is now a
pulldown at the top of the plot -- from here, you select which is the
"active" trace, i.e., which one is in the top layer and therefore
affected by changes you make. There is a legend on the plot specifying
which color corresponds to which trace. In this example, the plot has
appeared using a blue and green color scheme, which may be too hard to
differentiate. To change the second plot points' color, click on the gears,
ensure "Modify Trace" is selected, select "trace 1" (as opposed to
"trace 0", the first one you loaded), go down and expand the "Trace
Options" and pick a different color. You can also change the legend
name from "Trace 1" to, in this case, "W2." Click "apply"
to apply the changes to the plot:<br> 
<img src="img/overplot5.png"><P>

Note that once you change the trace name, the relevant pull-down menus
and legends update accordingly:<br>
<img src="img/overplot7.png"><P>


Note that the pop-up spawned by clicking the gears now has additional
options at the top: "Add New Chart", "Overplot New Trace", "Modify
Trace", and "Remove Active Trace." From here, you can modify a trace
you have already plotted (as described above), overplot another trace
(also as described above), or remove the selected trace:<br> <img
src="img/overplot6.png"><P>





<h3><a name="adding">Adding Plots</A> </h3>

To make additional plots from a loaded catalog, there are two ways to
do it: the blue "charts" tab on the top, or the plot's gears
pop-up.<P>

First, from the blue "charts" tab on the top.  This brings up a dialog
from which you can choose to make another scatter plot (left below), a
heatmap (center below), or a histogram (right below): <br> <img
src="img/charts2.png" width="30%">&nbsp;&nbsp;<img
src="img/charts3.png" width="30%">&nbsp;&nbsp;<img
src="img/charts.png" width="30%"><br>  The options for these plots
here are very similar to what is described above. You can specify
which columns to plot or manipulate and plot, specify labels, etc. <P>

<strong>Scatter plots</strong> allow you to choose points, connected
points, or lines; you can add errors to each point. There is a maximum
of 15,000 points for scatter plots.<P>

<strong>Heatmap plots</strong> are binned scatter plots; you can
choose what color scale and how many bins to use. <P>

<strong>Histogram plots</strong> allow you to choose how many bins or
the bin width.  Note that, if you provide a minimum number, the
binning starts at the minimum value you provide, and may exceed the
maximum you entered in order to fit in a whole bin. <P>

You can change what is plotted after plotting by
clicking on the gears. <P>

Using this "charts" tab, you can have as many  plots up at the same
time as you need. Note that many plots of a large catalog may make
your browser run slowly; it will refuse to make a scatter plot for
catalogs with &gt;15,000 points.  <P>

You can view multiple plots all at once or one at a time by clicking on
the corresponding icons above the plots (just as when you have
multiple images loaded): <img src="img/singlegrid.png">. If you are
viewing one at a time and have more than one plot loaded, you can
scroll between them by clicking on the arrows (just as when you have
multiple images loaded).<P>

You can also create a new plot from the gears pop-up. Select "Add New
Chart", and set what should be plotted as above.<br> <img
src="img/charts4.png" width="30%">&nbsp;&nbsp;<img
src="img/charts5.png" width="30%">&nbsp;&nbsp;<img
src="img/charts6.png" width="30%"><p>  


<h3><a name="example">Example plots</A></h3>

Here are several more examples of plots made with IRSA tools.<P>

Phase-folded light curve from K2 data: <br>
<img src="img/demo1.png"><P>


Plot on the sky of stars where the color of the point is scaled to
brightness in WISE-4: <br> <img src="img/demo2.png"><p>

Gaia distance (in kpc, from Bailer-Jones et al. 2018), with asymmetric
errors, as a function of Gaia G magnitude, with colors of the point
scaled to brightness in WISE-4: <br> <img src="img/demo3.png"
width="100%"><p>

[W1] light curve of Neptune over
several years, with colors of the point scaled to heliocentric
distance: <br> <img src="img/demo4.png"><P>

Absolute Gaia color-magnitude diagram of candidate members of a
star-forming region (note some background giants still in the list),
where point size is scaled by WISE-4 brightness: <br> <img
src="img/demo5.png"><P>



</BODY>
</HTML>
